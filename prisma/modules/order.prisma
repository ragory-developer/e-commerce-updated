model Order {
  id String @id @default(cuid())

  orderNumber Int @unique @default(autoincrement()) @map("order_number")

  customerId String?   @map("customer_id")
  customer   Customer? @relation(fields: [customerId], references: [id], onDelete: SetNull)

  customerEmail     String  @map("customer_email") @db.VarChar(191)
  customerPhone     String? @map("customer_phone") @db.VarChar(50)
  customerFirstName String  @map("customer_first_name") @db.VarChar(191)
  customerLastName  String  @map("customer_last_name") @db.VarChar(191)

  billingAddress Json @map("billing_address") @db.JsonB

  shippingAddress Json @map("shipping_address") @db.JsonB

  subTotal     Decimal @map("sub_total") @db.Decimal(18, 4)
  shippingCost Decimal @default(0) @map("shipping_cost") @db.Decimal(18, 4)
  discount     Decimal @default(0) @db.Decimal(18, 4)
  taxTotal     Decimal @default(0) @map("tax_total") @db.Decimal(18, 4)
  total        Decimal @db.Decimal(18, 4)

  shippingMethod    ShippingMethod? @map("shipping_method")
  paymentMethod     PaymentMethod   @map("payment_method")
  trackingReference String?         @map("tracking_reference") @db.Text

  couponId   String? @map("coupon_id")
  couponCode String? @map("coupon_code") @db.VarChar(191)

  currency     String  @db.VarChar(10)
  currencyRate Decimal @map("currency_rate") @db.Decimal(18, 4)

  status OrderStatus @default(PENDING)

  notes Json? @db.JsonB

  locale    String  @db.VarChar(10)
  ipAddress String? @map("ip_address") @db.VarChar(45)
  userAgent String? @map("user_agent") @db.VarChar(500)

  paidAt      DateTime? @map("paid_at")
  shippedAt   DateTime? @map("shipped_at")
  deliveredAt DateTime? @map("delivered_at")
  canceledAt  DateTime? @map("canceled_at")

  products      OrderProduct[]
  taxes         OrderTax[]
  statusHistory OrderStatusHistory[]
  packages      OrderPackage[]
  transaction   Transaction?

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  createdBy String? @map("created_by")
  updatedBy String? @map("updated_by")

  deletedAt DateTime? @map("deleted_at")
  deletedBy String?   @map("deleted_by")

  @@index([customerId])
  @@index([status])
  @@index([orderNumber])
  @@index([paymentMethod])
  @@index([createdAt])
  @@index([paidAt])
  @@index([deletedAt])
  @@map("orders")
}
